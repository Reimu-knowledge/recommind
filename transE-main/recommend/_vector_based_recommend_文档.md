# _vector_based_recommend 方法文档

## 概述

`_vector_based_recommend` 是基于向量推理的智能推荐方法，通过分析学生学习状态，选择最适合的推荐策略，为学生提供个性化的题目推荐。

## 方法签名

```python
def _vector_based_recommend(self, student: StudentModel, num_questions: int) -> List[Dict]:
    """基于向量推理的智能推荐 - 增强版"""
```

**参数**：
- `student`: 学生模型对象
- `num_questions`: 推荐题目数量

**返回值**：
- 推荐题目列表，包含题目信息和推荐元数据

## 算法流程

### 1. 学习状态分析
分析学生当前学习状态，包括：
- **知识点掌握情况**：薄弱/中等/已掌握知识点分类
- **学习趋势**：通过向量历史和答题表现分析学习趋势
- **能力水平**：评估为 struggling/beginner/intermediate/advanced
- **知识连通性**：分析知识点间的关联关系

### 2. 策略选择
基于学习状态，通过多因素权重计算选择推荐策略：

| 策略 | 英文名称 | 适用场景 |
|-----|---------|----------|
| 查漏补缺 | gap_filling | 薄弱知识点较多时 |
| 巩固练习 | consolidation | 中等掌握度知识点较多时 |
| 知识拓展 | expansion | 已掌握知识点较多时 |
| 平衡推荐 | balanced | 平衡各种知识点 |

### 3. 推荐执行
- **单一策略**：batch_count ≤ 3 时使用单一策略
- **混合策略**：batch_count > 3 时使用多策略组合，避免单一策略局限性

## 四种推荐策略

### gap_filling (查漏补缺)
- 针对薄弱知识点进行推荐
- 优先选择与已掌握知识点相关的薄弱点
- 降低题目难度，确保成功率

### consolidation (巩固练习)
- 针对中等掌握度知识点
- 结合部分已掌握知识点进行巩固
- 平衡难度，稳步提升

### expansion (知识拓展)
- 基于已掌握知识点探索新知识
- 使用多种关系向量（先修、相似、进阶）
- 提高题目难度，促进突破

### balanced (平衡推荐)
- 综合考虑各层次知识点
- 提供均衡的学习体验

## 难度自适应机制

### 题目难度估算
```python
# 基于学生掌握度动态计算题目难度
difficulty = (1.0 - mastery_level) * weight + complexity_factor
```

### 难度适配
根据学生能力水平匹配最佳难度范围：
- **struggling**: 0.2-0.4 (简单题目建立信心)
- **beginner**: 0.3-0.5 (适中难度逐步提升)
- **intermediate**: 0.4-0.7 (中等难度保持挑战)
- **advanced**: 0.6-0.9 (高难度促进突破)

## 评分体系

每个候选题目通过四个维度评分：

| 维度 | 说明 | 权重 |
|-----|------|------|
| 覆盖度 | 与目标知识点的关联强度 | 0.3-0.5 |
| 关联性 | 与已掌握知识点的重叠度 | 0.2-0.3 |
| 多样性 | 涉及知识点的广度 | 0.1-0.3 |
| 适配度 | 难度与能力的匹配程度 | 0.2 |

不同策略采用不同的权重配置以优化推荐效果。

## 质量评估

推荐结果通过四个维度评估质量：
1. **覆盖多样性**：知识点覆盖的广度
2. **难度适宜性**：题目难度的匹配程度
3. **学习进阶性**：题目间的知识关联度
4. **个性化程度**：针对学生特点的匹配度

## 使用示例

```python
# 获取推荐
recommendations = recommender._vector_based_recommend(student, 3)

# 查看结果
for q in recommendations:
    print(f"题目: {q['qid']}")
    print(f"策略: {q['recommendation_strategy']}")
    print(f"评分: {q['recommendation_score']:.3f}")
```

## 技术特点

- **智能决策**：多因素权重计算选择最佳策略
- **自适应难度**：根据学生能力动态调整题目难度
- **混合策略**：避免单一策略局限，提供丰富学习体验
- **质量保证**：四维度评估确保推荐质量
- **可扩展性**：支持新策略和评分维度的扩展

---

*版本: v2.0 | 更新: 2025.9.11*
